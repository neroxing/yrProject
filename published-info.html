<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<title></title>
	<meta charset="utf-8">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="title" content="">
	<!--meta name="viewport" content="width=device-width, initial-scale=1"-->
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="robots" content="index, follow">

	<!-- Bootstrap css -->
	<link rel="stylesheet" href="css/bootstrap.min.css">

	<!-- Bootstrap theme -->
	<link rel="stylesheet" href="css/bootstrap-theme.min.css">

	<!-- fontawesome css -->
	<link rel="stylesheet" href="css/font-awesome.min.css">

	<!-- customized css -->
	<link rel="stylesheet" href="css/yr.css">

	<style type="text/css">
		.panel.panel {
			border: 1px solid #c2c2c2;
		}

		.bg-explanation {
			background-color: #f5f5f5;
			padding: 20px;
		}

		.p-info {
			padding-bottom: 10px;
			margin-bottom: 10px;
			border-bottom: 1px dashed #c2c2c2;
		}
	</style>
</head>
<body>
<div class="container">
	<div class="col-sm-offset-2 col-sm-10">
		<div class="panel panel-defaultl">
			<div class="panel-body">
				<!--说明-->
				<div class="bg-explanation">
					<div>
						<i class="fa fa-lightbulb-o"></i>说明
					</div>
					<ol>
						<li>刷新:相当于新发一条信息，在按时间排序的情况下信息将靠前显示。每天可免费刷新一次。</li>
						<li>审核中:审核中的信息除了您自己外，其他人无法看到，工作人员会在24小时内为您审核。</li>
					</ol>
				</div>
				<!--已发布的信息-->
				<div class="panel panel-default">
					<div class="panel-heading text-right">
						<div>最后更新：2016-05-16</div>
					</div>
					<div class="panel-body">
						<div>
							<div class="p-info">
								<div class="row">
									<div class="col-sm-5">
										<h2><strong>杭州基金公司500万寻优质移动互联网项目</strong></h2>
										<div>
											浙江某天使资金500万寻互联网项目投资，只要想法够好，我方
										</div>
										<div>
											股权投资 10万-500万
										</div>
									</div>
									<div class="col-sm-2">
										<h2>审核未通过</h2>
										<div>原因:投资要求概述请具体描述</div>
									</div>
									<div class="col-sm-3">
										<h2>完整度评分</h2>
										<div class="progress" style="margin-bottom: 0px">
											<div class="progress-bar" role="progressbar" aria-valuenow="90"
											     aria-valuemin="0" aria-valuemax="100" style="width: 85%;">
												85分
											</div>
										</div>
										<div>还不错，再接再厉！</div>
									</div>
									<div class="col-sm-2">
										<h2>未委托</h2>
										<div>刷新</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									浏览:0 留言:0 收藏:0 收到投递:0
								</div>
								<div class="col-sm-6 text-right">
									<a class="title">权限设置</a>
									<a class="title">修改</a>/
									<a class="title">删除</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="panel panel-default">
					<div class="panel-heading text-right">
						<div>最后更新：2016-05-16</div>
					</div>
					<div class="panel-body">
						<div>
							<div class="p-info">
								<div class="row">
									<div class="col-sm-5">
										<h2><strong>杭州基金公司500万寻优质移动互联网项目</strong></h2>
										<div>
											浙江某天使资金500万寻互联网项目投资，只要想法够好，我方
										</div>
										<div>
											股权投资 10万-500万
										</div>
									</div>
									<div class="col-sm-2">
										<h2>审核未通过</h2>
										<div>原因:投资要求概述请具体描述</div>
									</div>
									<div class="col-sm-3">
										<h2>完整度评分</h2>
										<div class="progress" style="margin-bottom: 0px">
											<div class="progress-bar" role="progressbar" aria-valuenow="90"
											     aria-valuemin="0" aria-valuemax="100" style="width: 85%;">
												85分
											</div>
										</div>
										<div>还不错，再接再厉！</div>
									</div>
									<div class="col-sm-2">
										<h2>未委托</h2>
										<div>刷新</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									浏览:0 留言:0 收藏:0 收到投递:0
								</div>
								<div class="col-sm-6 text-right">
									<a class="title">权限设置</a>
									<a class="title">修改</a>/
									<a class="title">删除</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<nav class="pull-right">
					<ul class="pagination">
						<li>
							<a href="#" aria-label="Previous">
								<span aria-hidden="true">上一页</span>
							</a>
						</li>
						<li><a href="#">1</a></li>
						<li><a href="#">2</a></li>
						<li><a href="#">3</a></li>
						<li><a href="#">4</a></li>
						<li>
							<a href="#" aria-label="Next">
								<span aria-hidden="true">下一页</span>
							</a>
						</li>
					</ul>
				</nav>
			</div>
		</div>
	</div>
</div>


<!-- jQuery -->
<script src="js/jquery-1.11.3.js"></script>

<!-- Bootstrap JavaScript -->
<script src="js/bootstrap.js"></script>

<!-- custom js
<script src="js/请输入.js"></script>-->

<script type="text/javascript">
	function ajaxLoadinfo(url) {
		$.ajax({
			type: 'GET',
			url: url,
			dataType: 'json',
			success: function (data) {
				var str = '';
				$.each(data.data.rows, function (n, value) {
					var info = (['<div class="panel panel-default">',
						'					<div class="panel-heading text-right">',
						'						<div>最后更新：2016-05-16</div>',
						'					</div>',
						'					<div class="panel-body">',
						'						<div>',
						'							<div class="p-info">',
						'								<div class="row">',
						'									<div class="col-sm-5">',
						'										<h2><strong>' + value.title + '</strong></h2>',
						'										<div>',
						'											' + value.capital_requirements + '',
						'										</div>',
						'										<div class="amount">',
						'											' + value.capital_type + ' <span>' + value.down_amount + '</span>-<span>' + value.up_amount + '</span>',
						'										</div>',
						'									</div>',
						'									<div class="col-sm-2">',
						'										<h2>' + value.state + '</h2>',
						'										<div>原因:' + value.reason + '</div>',
						'									</div>',
						'									<div class="col-sm-3">',
						'										<h2>完整度评分</h2>',
						'										<div class="progress" style="margin-bottom: 0px">',
						'											<div class="progress-bar" role="progressbar" aria-valuenow="90"',
						'											     aria-valuemin="0" aria-valuemax="100" style="width: ' + value.rank + '%;">',
						'												' + value.rank + '分',
						'											</div>',
						'										</div>',
						'										<div>还不错，再接再厉！</div>',
						'									</div>',
						'									<div class="col-sm-2">',
						'										<h2>未委托</h2>',
						'										' + ((value.state === '已通过') ? '<a class="to-hot">刷新</a>' : '<div>刷新</div>') + '',
						'									</div>',
						'								</div>',
						'							</div>',
						'							<div class="row">',
						'								<div class="col-sm-6">',
						'									浏览:'+value.ext.record+' 留言:'+value.ext.message+' 收藏:'+value.ext.collection+' 收到约谈:'+value.ext.record+'',
						'								</div>',
						'								<div class="col-sm-6 text-right">',
						'									<a class="title">权限设置</a>',
						'									<a class="title">修改</a>/',
						'									<a class="title delete" onclick="infoDelete(' + value.pk_capital + ')">删除</a>',
						'								</div>',
						'							</div>',
						'						</div>',
						'					</div>',
						'				</div>'].join(""));
					str += info;
				})
				$('#pub-info').html($(str));
				$('.amount span').each(function () {
					var amount = $(this).text();
					if (!isNaN(amount)) {
						(amount > 100000000) ? amount = amount / 100000000 + '亿' : amount = amount / 10000 + '万';
						$(this).text(amount);
					}
				})
				/*分页*/
				var pagenation = '';
				var total = data.data.total;
				var page = data.data.page;
				(page != 1) ? pagenation += ('<li><a>首页</a></li>') : null;
				(total > 1 && page > 1) ? pagenation += ('<li><a>上一页</a></li>') : null;
				if (total <= 5 || page < 5) {

					for (var i = 1; i <= Math.min(total, 5); i++) {
						if (i == page) {
							pagenation += ('<li class="active"><a>' + i + '</a></li>');
						}
						else {
							pagenation += ('<li><a>' + i + '</a></li>');
						}
					}
					(total > 5) ? pagenation += ('<li><span>···</span></li><li><a>' + total + '</a></li>') : null;
				}
				else {
					((page - 2) > 0) ? pagenation += ('<li><a>' + (page - 2) + '</a></li>') : null;
					((page - 1) > 0) ? pagenation += ('<li><a>' + (page - 1) + '</a></li>') : null;
					pagenation += ('<li class="active"><a>' + page + '</a></li>');
					((page + 1) <= total) ? pagenation += ('<li><a>' + (page + 1) + '</a></li>') : null;
					((page + 2) <= total) ? pagenation += ('<li><a>' + (page + 2) + '</a></li>') : null;
					(total > (page + 2)) ? pagenation += ('<li><span>···</span></li></li><li><a>' + total + '</a></li>') : null;
				}
				(total > 1 && page < total) ? pagenation += ('<li><a>后一页</a></li>') : null;
				(page != total && total > 0) ? pagenation += ('<li><a>最后一页</a></li>') : null;
				$('.pagination').html($(pagenation));
				$('.pagination li a').click(function () {
					var pageCount = this.text;
					if (pageCount != page) {
						var pageUrl = '115.236.94.196:30000/blade/capital/mylist?';
						switch (this.text) {
							case '上一页':
								pageCount = (page - 1);
								break;
							case '后一页':
								pageCount = (page + 1);
								break;
							case '首页':
								pageCount = 1;
								break;
							case '最后一页':
								pageCount = total;
								break;
							default:
								console.log("页数不存在");
								break;
						}
						pageUrl += 'page=' + pageCount;
						ajaxLoadinfo(pageUrl);
					}
				})
			}
		})
	}
	function infoDelete(pk) {
		event.returnValue = confirm("你确认要删除吗？");
		if (event.returnValue) {
			$.ajax({
				type: 'POST',
				url: '115.236.94.196:30000/blade/capital/remove/' + pk + '',
				dataType: 'json',
				success: function (data) {
					if (data.code == 0) {
						ajaxLoadinfo('115.236.94.196:30000/blade/capital/mylist/');
					}
					else {
						alert(data.message);
					}
				}
			})
		}
	}
	$(document).ready(function () {
		ajaxLoadinfo('115.236.94.196:30000/blade/capital/mylist/');
	})
</script>
</body>
</html>